(()=>{let e=new MutationObserver(e=>{e.forEach(e=>{"childList"==e.type&&(e.removedNodes.forEach(e=>{o(e).forEach(e=>{e[h.cleanup]&&e[h.cleanup]()})}),e.addedNodes.forEach(e=>{o(e).forEach(e=>{e[h.append]&&e[h.append]()})}))})});function n(e){return"string"==typeof e||"number"==typeof e}function t(e){if(e)return Object.getPrototypeOf(e)==Object.prototype}function l(e){for(let n in e){let o=e[n];o&&t(o)?l(o):o instanceof Map?o.forEach((e,n)=>{l(e),o.delete(n)}):o instanceof Set?(o.forEach(e=>{l(e)}),o.clear()):Array.isArray(o)&&o.forEach(e=>{l(e)}),delete e[n]}}function o(e){let n=[];return!function e(t){(1==t.nodeType||3==t.nodeType)&&n.push(t),t.childNodes&&t.childNodes.forEach(n=>e(n))}(e),[...new Set(n)]}e.observe(document.body,{childList:!0,subtree:!0});let i=new Map,s=new Map,r=(e,...t)=>{let l;if("t"==e||"text"==e||"textnode"==e)return new Text(t[0]);l="f"==e||"frag"==e||"fragment"==e?document.createDocumentFragment():document.createElement(e);let o=[];return t.forEach(e=>{void 0!=e&&null!=e&&(n(e)?o.push(document.createTextNode(e)):e instanceof Node?o.push(e):"function"==typeof e&&o.push(k(e)))}),o.forEach(e=>{l.appendChild(e)}),t=null,o=null,l},a=new Proxy({},{get:(e,n)=>(...e)=>r(n.toLowerCase(),...e)});function u(e,n){setTimeout(()=>{"function"==typeof e.destroy&&e.destroy(),e.remove(),e=null,n(),n=null},3e3)}function c(e,n,...t){return function(){e();let l=i.get(n);l&&l(...t)}}function f(e,...n){let r={},f;n.forEach((e,l)=>{t(e)&&(r={...e},delete n[l])}),f=a[e](...n);let d,m,E;if(d=new Map,m=new Set,E=new Set,r&&Object.keys(r).length)for(let k in r)if("use"==k)r[k].call(f);else if("sync"==k)m.add(r[k].bind(f));else if(k.startsWith("on")){let y=k.slice(2).toLowerCase();d.set(y,r[k].bind(f)),f.addEventListener(y,d.get(y)),y=null}else if("function"==typeof r[k])m.add(c(w(f,k,r[k]),p.RenderINDEX,{method:"property",key:k,element:f}));else if("style"==k){if("string"==typeof r[k])f[k]=r[k];else if("function"==typeof r[k])m.add(c(w(f,"style",r[k]),p.RenderINDEX,{method:"style",key:k,element:f}));else if(t(r[k])){let g=r[k];for(let v in g)"function"==typeof g[v]?m.add(c(()=>b(f,v,g[v]()),p.RenderINDEX,{method:"style",key:k,element:f})):f.style[v]=g[v];g=null}}else T.includes(k)?f[k]=r[k]:f.setAttribute(k,r[k]);let x={memo:p.memo,evented:Boolean(d.size),hooks:{},states:[],index:p.RenderINDEX,append(){x.evented||(d.forEach((e,n)=>{f.addEventListener(n,e)}),x.evented=!0),Boolean(E.size)||m.forEach(e=>{E.add(C(e))})},clear(){x.evented&&(d.forEach((e,n)=>{f.removeEventListener(n,e)}),x.evented=!1),E.forEach(e=>{e&&e.remove()}),E.clear()},delete(){i.has(x.index)&&i.delete(x.index),s.has(x.index)&&s.delete(x.index),x.clear(),l(d),d=null,E.forEach(e=>{l(e)}),l(E),E=null,l(x.hooks),x.hooks=null,x.states.forEach(e=>{e&&e.kill&&e.kill()})}};function H(e,n){x.memo=Boolean(e),n||o(f).forEach(e=>{e[h.memo](x.memo)})}function D(e){if(x.hooks&&x.hooks.onRemove&&x.hooks.onRemove.call(f),!x.memo||e){f[h.cleanup]=null;let n=o(f),t=[];n.forEach(e=>{e[h.index]==x.index&&(e.remove(),t.push(e))}),n.forEach(n=>{n[h.cleanup]&&n[h.cleanup](e)}),u(f,()=>f=null),n=null,l(t),t=null,x.delete(),l(x),delete f[h.memo],delete f[h.append],delete f[h.setHooks],delete f[h.index],x=null,H=null,L=null,$=null,D=null}else x.clear()}function L(){x.hooks&&x.hooks.onConnect&&x.hooks.onConnect.call(f),x.append()}function $(){let e=p.TempHooks,n=e[e.length-1],t=p.TempWatchers,l=t[t.length-1],o=p.states,r=o[o.length-1];n&&(x.hooks=e.pop(),x.hooks.onEffect&&i.set(x.index,x.hooks.onEffect),x.hooks.onSignal&&s.set(x.index,x.hooks.onSignal)),l&&t.pop().forEach(e=>{m.add(e)}),r&&(x.states=o.pop()),l=null,t=null,r=null,o=null,n=null,e=null}return f[h.index]=x.index,f[h.setHooks]=$,f[h.cleanup]=D,f[h.memo]=H,f[h.append]=L,f}HTMLElement.prototype.destroy=function(){this.outerHTML=null},HTMLElement.prototype.send=function(e){let n=this[h.index];if(void 0!=n&&s.has(n)){let t=s.get(n);t({from:this,signal:e}),t=null}n=null};let d=new Proxy({},{get:(e,n)=>(...e)=>f(n,...e)}),p={symbols:{memo:Symbol(),cleanup:Symbol(),append:Symbol(),setHooks:Symbol(),index:Symbol()},memo:!1,TempHooks:[],TempWatchers:[],states:[],state:"IDLE"},h=p.symbols;function m(e,n){let t=h.cleanup;e[t]&&e[t](n)}let E=0;function k(e){p.state="RECORD",p.RenderINDEX=E++,p.states.push([]),p.TempHooks.push({}),p.TempWatchers.push([]);let n=e();if(n[h.setHooks])n[h.setHooks]();else{let t=p.states.pop(),l=p.TempHooks.pop(),o=p.TempWatchers.pop();(t.length||Object.keys(o).length||Object.keys(l).length)&&console.warn("DynaView Component-Scope Warning:\nThis component uses hooks and state management, but the first element is not a suitable HTML element. This may lead to memory leaks. Please ensure the first element is a valid one."),t.forEach(e=>e.kill()),l=null,o=null}return p.state="IDLE",n}function y(e){p.memo=!0;let n=k(e);return p.memo=!1,n}function g(e,n){return o(e).forEach(e=>{e[h.memo]&&e[h.memo](n??!0,!0)}),e}let T=["innerText","inner","textContent","className","nodeValue","style","innerHTML","outerHTML","dataset","contentEditable","draggable","checked","disabled","required","value","alt","role"];function w(e,n,t){return T.includes(n)?()=>x(e,n,t()):()=>v(e,n,t())}function v(e,n,t){e.getAttribute(n)!==t&&e.setAttribute(n,t)}function b(e,n,t){e.style[n]!==t&&(e.style[n]=t)}function x(e,n,t){e[n]!==t&&(e[n]=t)}let H=[];function D(e){let n=new Set,t={initial:e,get:()=>(H.length&&H[H.length-1].add(n),t.initial),set(e){let l=t.initial;return t.initial=e,l!==e&&n.forEach(e=>e({before:l,current:t.initial})),e}};function o(e){if(void 0!==e){let n="function"==typeof e?e(t.initial):e;return t.set(n)}if(e=null,t)return t.get()}return o.kill=function(){l({set:n,data:t}),n=null,t=null,o.kill=null,o=null},"RECORD"==p.state&&p.states[p.states.length-1].push(o),o}function L(e,n){let t=D(e),l;function o(e,...l){if(void 0===e)return t();{let o=n(t(),e,...l);if(void 0!=o)return t(o)}}return o.kill=()=>{l=null,t=null,o=null},l=t.kill,t.kill=()=>{l(),o.kill()},o}function $(e){let n=D(1),t=C(()=>{n(e())}),l=n.kill;return n.kill=()=>{t.kill(),l(),l=null,n=null,t=null,e=null},n}function C(e){H.push(new Set);let n=e(),t=H.pop();if(0==t.size)return n;n=null;let o={append(){t.forEach(n=>{n.add(e)})},remove(){t.forEach(n=>{n.delete(e)})},kill(){for(o.remove();t.length;)t.pop();t=null,l(o),e=null},trigger:e};return o.append(),o}function R(e){let n=p.TempWatchers,t=n[n.length-1];if("RECORD"!=p.state)return console.warn(`DynaView WATCH Warn:
This hook must be in a component scope! Use 'watch' instead of 'Watch' in non-component contexts.`),C(e);t.push(e),n=null,t=null}let N=new Proxy({},{get:(e,n)=>function(e){let t=p.TempHooks,l=t[t.length-1];"RECORD"==p.state?(l[n]&&console.warn(`DynaView HookSet-${n.toUpperCase()} Warn:
${n} hook already set!`),l[n]=e):console.warn(`DynaView HookSet-${n.toUpperCase()} Warn:
This hook must be in a component scope!`),e=null,t=null,l=null}});function W(e){let n=D(new Text);return C(()=>{let t=n();n(k(e)),t.replaceWith(g(n())),m(t),t=null}),n()}let{onConnect:_,onRemove:M,onEffect:I,onSignal:S}=N;function V(e,n,...t){let l,o,i;"string"==typeof e?l=document.querySelector(e):e instanceof HTMLElement?l=e:i+=" target must be a HTMLELEMENT -","function"==typeof n?o=k(()=>n(...t)):n instanceof HTMLElement?o=n:i+=" output must be a HTMLELEMENT -",i?console.error("DynaView Mount Error:\n"+i):l.appendChild(o)}Object.assign(window,{Elements:d,A:a,Mount:V,onConnect:_,onRemove:M,onEffect:I,onSignal:S,Watch:R,watch:C,createComputed:$,createReducer:L,createState:D,Remember:g,Memo:y,Render:k,Cleanup:m,Switch:W})})();